Семантическая сегментация изображений является процессом разделения изображения на отдельные составные части, которые соответствуют различным объектам, и последующего выполнения классификации данных объектов. Сегодня семантическая сегментация применяется в различных областях, например в системах видеонаблюдения для распознавания людей, в беспилотных автомобилях для анализа окружающей среды, в смартфонах для классификации объектов, в медицине для анализа рентгеновских снимков и т.д. Данная область является одной из самых активно развивающихся, однако качество работы большинства современных алгоритмов еще не достигло максимума. Поэтому зачастую часть работы, требующая высокой ответственности, выполняется людьми в ручном режиме, из-за чего могут возникать ошибки и увеличиваться время выполнения работы.
Сегодня существует ряд эффективных алгоритмов, которые применяются в задачах сегментации. Как правило, в основе большинства из них лежат поиск ключевых характеристик объектов на изображениях и последующая классификация данных объектов. В качестве ключевых характеристик могут использоваться различные параметры: цвет, форма, размер, текстура и т.д.
Алгоритмы, основанные на поиске особых точек для описания объектов на изображениях: SURF; SIFT; MSER; FAST; FAST-9; FAST-ER; HOG. Особыми точками являются такие области изображения, которые сохраняют свои характеристики при различных изменениях условий сьемки и смещениях камеры. К достоинствам методов поиска особых точек можно отнести их высокую устойчивость к масштабированию и незначительному повороту изображения объекта.
Недостаток подобных методов – неустойчивость к специфичным изображениям объекта, на которых нельзя определить направления дескрипторов, к смене освещения. Алгоритмов классификаторов большое множество. Например, можно выделить следующие: SVM, Bag of words. Также к алгоритмам классификаторов можно отнести искусственные нейронные сети.
В основе алгоритма SVM лежит принцип нахождения гиперплоскости, которая разделяет объекты на несколько классов. Для выполнения качественной классификации необходимо нахождение данной гиперплоскости на достаточном расстоянии от объектов. Применение данного алгоритма не требует наличия большой обучающей выборки, так как используется не все множество, а лишь некоторая часть объектов на границах областей, что может быть причиной ошибок при классификации.
В основе работы алгоритма Bag of words лежат нахождение ключевых точек изображения и построение нормированной гистограммы встречаемости «слов», описывающей изображение. Недостаток данного алгоритма заключается в том, что он не учитывает пространственную информацию объектов, поэтому могут возникать ошибки классификации при наличии схожих ключевых точек объектов.
Классические полносвязные искусственные нейронные сети, также называемые многослойным персептроном, не очень подходят для обработки изображений. Это связано с тем, что изображения, как правило, имеют большой размер и состоят из большого количества пикселей, поэтому необходимо, чтобы нейронная сеть состояла из большого количества нейронов и связей. Это приводит к тому, что нейронная сеть становится очень громоздкой и сложнообучаемой. Еще один недостаток заключается в том, что классические нейронные сети не учитывают двумерную структуру изображений и плохо запоминают пространственную взаимосвязь объектов и их составных частей.
В 1998 г. был разработан тип нейронных сетей, которые хорошо подходят для обработки изображений. Такие нейронные сети называются сверточными нейронными сетями, они обеспечивают высокую устойчивость к искажениям объектов, наличию шумов, сдвигам и смене ракурса сьемки.
Они имеют двумерную структуру, аналогичную структуре изображений, и анализируют изображение не целиком, а по отдельным частям. Этот процесс обеспечивается наличием специальных сверточных и подвыборочных слоев, которые от слоя к слою уменьшают размер входного сигнала. Таким образом, создается пирамида из слоев нейронной сети, где каждый отдельный слой содержит набор плоскостей. В рамках каждой плоскости применяется свой набор весов. Каждый нейрон выполняет операцию свертки двумерной области нейронов предыдущего слоя. Сверточные нейронные сети обеспечивают более быстрое и эффективное обучение, так как содержат меньшее количество настраиваемых весовых коэффициентов.
Целью работы является разработка алгоритмов семантической сегментации областей лесных пожаров на спутниковых снимках земной поверхности.
Основные задачи:
1. Выбор среды разработки и программных библиотек для реализации алгоритмов.
2. Создание и подготовка обучающей выборки снимков дистанционного зондирования Земли.
3. Разработка нейронной сети.
4. Сравнение реализованных алгоритмов с аналогами.
1. Выбор библиотеки машинного обучения
При выборе программных средств для разработки нейронных сетей было изучено несколько библиотек машинного обучения:
Keras – открытая библиотека машинного обучения, которая поддерживается компанией Google. Данная библиотека является надстройкой для более низкоуровневой библиотеки TensorFlow, содержит очень удобный функционал для реализации и обучения нейронных сетей, в том числе и в задачах компьютерного зрения.
PyTorch – библиотека машинного обучения, разработанная NEC Laboratories America и New York University. Библиотека включает широкий выбор алгоритмов машинного обучения и подходит для научных вычислений. Использует динамический граф вычислений, что обеспечивает удобство и снижение временных затрат, так как позволяет изменять структуру нейронной сети перед каждым запуском без предварительной компиляции.
Эффективность применения библиотек исследовалась на наборе изображений CIFAR-10. Данный набор содержит изображения различных классов объектов: животные, автомобили, самолеты, техника и т.д. Количество изображений – 60 000. Для тестирования библиотек применялась классическая сверточная нейронная сеть VGG16.
В результате тестирования библиотеки Keras и TensorFlow показали результат скорости работы на уровне 236 с. Библиотека PyTorch показала результат 153 с. Все библиотеки показали точность работы на уровне 79%. Исходя из полученных результатов было принято решение использовать PyTorch для дальнейшей работы.

2. Структура нейронной сети

Как правило, архитектура и различные параметры нейронной сети выбираются экспериментальным путем. Это обусловлено тем, что сверточные нейронные сети содержат большое количество параметров, и на сегодняшний день не существует строго формализованных правил подбора этих параметров и структуры сети в целом. Рассматривались следующие варианты: U-Net, ENet, SegNet.
U-Net состоит из двух частей: сжимающейся части для вычисления характеристик и расширяющейся части для пространственной локализации объектов на изображении. В данной модели не используется полносвязный слой. Как следствие, число параметров модели уменьшается, и ее можно обучить с помощью небольшого набора данных.
SegNet, как и U-Net, состоит из двух частей. Сжимающая часть содержит несколько сверточных слоев с функцией активации ReLU, пакетную нормализацию и операции подвыборки.
Это обеспечивает важные преимущества сохранения высокочастотных деталей в сегментированных изображениях, а также уменьшения общего количества настраиваемых параметров в декодерах.
Enet имеет более компактную структуру и содержит в несколько раз меньше параметров, что обеспечивает более высокую скорость работы и возможность применения на мобильных устройствах в режиме реального времени.
В процессе проведенных экспериментов архитектура SegNet показала лучшие результаты в сравнении с аналогами, поэтому было решено использовать ее в качестве основы с дальнейшей модификацией ее архитектуры. В итоге после проведения ряда вычислительных экспериментов была разработана архитектура нейронной сети (рис. 1). Нейронная сеть состоит из двадцати слоев: 10 сверточных слоев, 5 слоев Max pooling, 5 слоев Upsampling, и выходного слоя.
Работу нейронной сети можно разделить на два этапа: свертка входного изображения и развертка полученного вектора.
Как показано на рис. 1, входное изображение проходит через пять слоев (обозначены синим и зеленым цветом), и выполняется свертка изображения в вектор. Далее следуют пять слоев (обозначены синим и красным цветом), которые выполняют функцию Upsampling и предназначены для развертывания полученного вектора в исходный размер изображения. На последних этапах полученные данные переводятся в три цветовых канала, и на выходе получаем результат сегментации.

3. Обучение нейронной сети

Обучение нейронной сети выполнялось с помощью сформированного набора из 50 снимков дистанционного зондирования Земли с разрешением 8 000 × 8 000. Набор изображений был отобран из базы спутника Landsat 8. Основные критерии выбора касались размера сцены, а также количества снимков, которые делает спутник в течении суток.
Сформированный набор изображений содержит данные следующих классов:
– лесной пожар (красный цвет);
– выгоревшая площадь (черный цвет);
– дым от пожара (белый цвет);
– водоемы (синий цвет);
– лес (зеленый цвет).
Создание сегментированных масок изображений производилось с помощью преобразований и фильтрации в программе Adobe Photoshop (рис. 2). Так же для набора изображений была проведена аугментация, т.е. модификация данных для обучения. Использование данного метода улучшает обобщающую способность нейронной сети, добавляет новые примеры для обучения, которые нейросеть еще не видела, и не дает возможности переобучаться.
В качестве аугментации были выполнены следующие модификации: поворот изображения на произвольный градус; сжатие по осям; растяжение по осям; зеркальное отображение по осям; Гауссово размытие; изменение яркости и контраста. Обучение включало 50 эпох, каждая из которых содержит 2 000 итерации.
На сегодняшний день существует множество алгоритмов обучения нейронных сетей. Один из наиболее известных – алгоритм обратного распространения ошибки. Алгоритм применяется для минимизации отклонения текущего значения выходного сигнала сети от требуемого. Недостаток данного алгоритма заключается в возможности переобучения при выборе малой скорости обучения или, наоборот, расходимости при выборе слишком большой скорости обучения.
Для устранения данных недостатков существуют различные модификации алгоритма обратного распространения ошибки. Проведен анализ трех модификаций данного алгоритма с целью выбора наилучшего: Adam – adaptive moment estimation; Adagrad – adaptive gradient; RMSProp – gradient descent with momentum. Основное отличие данных алгоритмов от классического алгоритма обратного распространения ошибки заключается в том, что в них используется адаптивная скорость обучения для каждого веса сети, которая адаптируется в процессе обучения.
Для более стабильного обучения применялся метод регуляризации DropOut, который предназначен для уменьшения переобучения сети за счет случайного обновления весов в некоторых областях сети. Вероятность попадания нейронов в область обновления: 0,5. Для стабильной работы применялся метод нормализации Mini-batch. В данном методе на вход нейронной сети подаются данные, которые были предварительно обработаны и имеют нулевое математическое ожидание и единичную дисперсию. Для регуляризации весов сети применялся метод L2, который назначает размер штрафной коррекции для слишком больших и малых значений весов.
Параметры нейронной сети, использованные при обучении и тестировании:
– коэффициент обучения: 0,0005;
– изменение коэффициента обучения: 0,1;
– частота изменения коэффициента обучения: 104.
Аппаратное обеспечение, используемое для экспериментов: Intel(R) Core(TM)6 CPU (3.7GHz), ОЗУ 32ГБ, GeForce RTX 2080 SUPER.
Результаты обучения представлены в табл. 1. Очевидно, что алгоритм Adam показывает лучшие результаты по сравнению с двумя другими алгоритмами: точность классификации 96,033 %.
Преимущества алгоритма Adam в задачах оптимизации состоят в следующем: достаточно прост в реализации; вычислительно эффективен в применении; инвариантен к изменению масштаба градиента по диагонали; эффективен для задач с большим количеством параметров и данных; эффективен для задач с очень шумными или редкими градиентами.
Результаты обучения нейронной сети представлены на рис. 3. В табл. 2 представлено сравнение результатов работы предложенной нейронной сети с некоторыми аналогами. Сравнительное исследование точности работы алгоритмов сегментации проводилось на наборе эталонных и тестовых изображений, подвергаемых шумовым искажениям. Для сравнения результатов сегментации использовались границы сегментированных объектов, которые представляет собой набор точек, не зависящих от закраски сегментов. Для измерения результатов сегментации использовались две метрики: среднее и Хаусдорфово расстояние. Исследование качества работы ряда алгоритмов показало, что они ведут себя неустойчиво при зашумлении и размытии изображения. Таким образом, можно сделать вывод, что целесообразно до процедуры сегментации выполнить очистку изображения от шума и повысить его четкость.
Точность работы разработанной нейронной сети составляет 94,22%. Данный результат является лучшим в сравнении с представленными аналогами. Как можно заметить, разработанная система несколько уступает некоторым аналогам по таким показателям, как пожар, выгоревшая площадь, дым.
Однако по таким показателям, как леса, водоемы, она побеждает.

Заключение

В данной работе рассматривалась задача семантической сегментации областей лесных пожаров на спутниковых снимках земной поверхности. Изображение сегментировалось на пять различных объектов: лесной пожар; выгоревшая площадь; дым от пожара; водоемы; лес. Разработана сверточная нейронная сеть глубокого обучения, которая обеспечивает точность работы на уровне 94,22%. Также было проведено сравнение эффективности работы алгоритмов обучения, в результате чего лучшие показатели были получены с помощью алгоритма Adam.