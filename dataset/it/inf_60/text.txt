Введение

В связи с повсеместным переходом в бурении от вертикальных скважин к скважинам с горизонтальным завершением существенно усложняется и расширяется круг задач промысловой геофизики. При бурении горизонтального участка скважины применяют геонавигацию – оперативную корректировку траектории бурения с целью ее удержания в целевом нефтеносном пласте. Следует отметить, что геонавигация – это сложный процесс, требующий использования дорогостоящего оборудования и программного обеспечения (ПО), а также работы квалифицированных геофизиков-геонавигаторов. Решение о корректировке траектории принимают непосредственно в процессе бурения на основе каротажных данных с использованием приборов, входящих в состав буровой колонны. Стандартные программные комплексы, предназначенные для интерпретации каротажных данных из вертикальных скважин, не подходят для проведения геонавигации, что приводит к необходимости разработки специализированного ПО.
Каротаж в процессе бурения начал активно развиваться еще в 80-х гг. прошлого столетия. Несмотря на это, в России для каротажа в процессе бурения до сих пор используют приборы в основном только крупных иностранных нефтесервисных компаний: Baker Hughes, Halliburton, Schlumberger, Weatherford. В рамках реализации программ импортозамещения Научно-производственным предприятием геофизический аппаратуры «Луч» (НПП ГА «Луч», Новосибирск) и Институтом нефтегазовой геологии и геофизики им. А. А. Трофимука СО РАН (ИНГГ СО РАН, Новосибирск) разработан и опробован на месторождениях Западной Сибири аппаратурный комплекс «ЛУЧ». Комплекс включает в себя ряд приборов для проведения каротажа в процессе бурения, при этом набор геофизических измерений достаточен для проведения как геонавигации, так и петрофизической интерпретации.
Оперативная интерпретация данных каротажа в процессе бурения может проводиться либо самим заказчиком – нефтедобывающей компанией, либо теми же нефтесервисными компаниями. Для нефтедобывающих компаний на российском рынке в настоящее время представлен ряд программных решений для геонавигации: «Геонафт» от компании Геонавигационные технологии, «Geosteering office» от Геонавигация, «StarSteer» от ROGII. Однако всё перечисленное ПО обладает одним недостатком: не использует наиболее продвинутые подходы для задач геонавигации, основанные на алгоритмах численных решений прямых и обратных задач электродинамики в классе реалистичных интерпретационных моделей.
Сервисные компании используют ПО, узко ориентированное на «свои» приборы. В связи с этим в ИНГГ СО РАН разработано ПО, позволяющее проводить геонавигацию скважин с использованием комплекса «ЛУЧ» двумя методами: корреляции каротажных данных и численной инверсии измерений электромагнитного каротажа (ЭМК).

Аппаратурный комплекс «ЛУЧ» для каротажа в процессе бурения

Приборы, входящие в состав комплекса каротажа в процессе бурения (рис. 1), позволяют проводить геофизические исследования в скважинах следующими методами:
• многозондовый высокочастотный индукционный каротаж (ВИКПБ);
• боковой сканирующий каротаж (БКС);
• гамма-каротаж (ГК);
• нейтрон-нейтронный каротаж по тепловым нейтронам (ННК-Т);
• гамма-гамма плотностной каротаж (ГГК-П);
• другие измерения (инклинометрия, положения угла отклонителя, температура, ударные нагрузки). Для решения ключевых задач геологического сопровождения бурения используют данные ЭМК из-за его наибольшей радиальной глубинности. Входящий в аппаратурный комплекс «ЛУЧ» прибор ВИКПБ, основанный на методе высокочастотного индукционного каротажа ВИКИЗ, выполняет измерения относительных амплитудно-фазовых характеристик эдс, наведенной в приемных катушках. Измерения эдс проводятся в двух основных и четырех дополнительных трехкатушечных зондах с длинами от 0,7 до 1,4 м на двух частотах 0,88 и 3,5 МГц. Зонды одинаковой длины различаются базой, т. е. расстоянием между дальней и ближней приемными катушками. В парах приемных катушек регистрируются разности фаз наведенных эдс Δφ и отношения амплитуд ΔA, а также выполняется их трансформация в кажущееся удельное электрическое сопротивление (УЭС).
Проведенные опытно-промышленные испытания приборов каротажа в процессе бурения «ЛУЧ» на месторождениях АО «НК «Роснефть» и АО «Сургутнефтегаз» показывают, что приборы соответствуют техническим и эксплуатационным требованиям для бурения наклонно направленных и горизонтальных скважин. Однако для успешной проводки скважины недостаточно одних приборов каротажа в процессе бурения, необходимо также и специализированное ПО для оперативной интерпретации геофизических данных.

Архитектура и ИТ-технологии

Разработанное ПО для геонавигации представляет собой веб-приложение, состоящее из трех основных структурных блоков: клиентского, серверного и вычислительного (рис. 2). Клиент отвечает только за визуализацию данных, что сводит к минимуму требования, предъявляемые к оборудованию. Использовать такое ПО можно на любых устройствах: от персональных компьютеров до смартфонов. Требуется лишь наличие веб-браузера и доступ к серверу по сети. При этом обновление приложения выполняется для всех клиентов одновременно благодаря использованию единого ресурса. Серверная часть обрабатывает пользовательские запросы, управляет очередностью выполнения ресурсоемких задач и возвращает результаты расчетов клиентам. В вычислительной части непосредственно производятся расчеты на серверах (кластерах) с использованием распределенных масштабируемых и высокопроизводительных параллельных вычислений. Ниже приведен полный стек технологий, использованный при разработке ПО:
• TypeScript и JavaScript – языки программирования (ЯП), используемые для создания графического интерфейса, отображаемого в браузерах;
• Angular – платформа для сборки веб-приложений из созданных компонентов и используемых библиотек;
• D3  – библиотека для визуализации в формате SVG сложных элементов: траектории скважины, моделей геологических пластов, каротажных данных;
• NodeJS  – платформа, позволяющая разрабатывать серверную часть на языке JavaScript;
• MongoDB  – нереляционная база данных для хранения учетных записей и пользовательских данных;
• RabbitMQ  – брокер сообщений для взаимодействия сервера с вычислительными модулями;
• Docker 8 – платформа для создания кроссплатформенных вычислений;
• С++, Fortran – ЯП, позволяющие разрабатывать высокопроизводительные вычислительные алгоритмы.

Клиент

Интерфейс, с которым работает пользователь, отображается в веб-браузере. За счет этого достигается кроссплатформенность клиентской части, поскольку веб-браузеры есть практически во всех операционных системах. Движок JavaScript V8, считывающий и исполняющий исходный код на JavaScript, а также другие аналоги встроены в большинство браузеров.
Однако не все браузеры в одинаковой степени хорошо поддерживают новые стандарты ЯП.
Поэтому для полной совместимости необходимо транслировать код в более старые версии JavaScript. Для этого в проекте используется язык TypeScript. Кроме того, статическая типизация, которая вводится TypeScript, фиксирует несоответствия типов на этапе трансляции в необходимый стандарт JavaScript до непосредственного выполнения программы. Это облегчает читаемость кода, а также помогает осуществлять поиск ошибок на этапе разработки и компиляции.
Для упрощения и ускорения разработки существуют различные фреймворки, определяющие структуру веб-приложения. Одним из наиболее известных является активно развивающийся Angular. Его отличительная особенность состоит в том, что он предназначен для разработки приложений именно на TypeScript. Для создания интуитивно понятного интерфейса используется библиотека Angular Material, являющаяся адаптацией Google Material Design. Этот пакет упрощает создание таких компонентов взаимодействия с интерфейсом, как кнопки, переключатели, вкладки и пр. В вышеописанной библиотеке реализованы только простые компоненты, поэтому не все элементы интерфейса могут быть отображены с ее помощью. Более сложные элементы, такие как каротажные диаграммы и графические изображения моделей, визуализируются с помощью библиотеки D3. Она отличается высокой производительностью, гибкостью и возможностью работы с масштабируемой векторной графикой.

Сервер

Серверная часть принимает запросы пользователей, выполняет их обработку, взаимодействует с вычислительной частью и отправляет результаты обратно клиенту. Для обеспечения доступности (возможности всегда отвечать на запросы пользователей) сам сервер не выполняет сложных вычислений. При получении запроса на проведение расчетов происходит генерация входных данных для вычислительных алгоритмов. Они добавляются в очередь сообщений с заданной меткой, затем выполняются расчеты, и результаты возвращаются обратно в очередь сообщений. Последние изымаются и обрабатываются, а пользователю отправляются данные для отображения.
Для разработки серверной части выбрана программная платформа NodeJS, позволяющая разрабатывать серверную и клиентскую части на одном ЯП. NodeJS основана на движке V8, транслирующем JavaScript в машинный код. Поскольку для введения типизации используется TypeScript, перед запуском код транслируется в JavaScript, используя компилятор TypeScript. Для хранения пользовательских учетных записей и геофизических данных используется NoSQL база данных MongoDB. MongoDB предназначена для хранения данных без задания схем. Это позволяет проще менять формат хранимой информации, в сравнении с SQL решениями. Для взаимодействия с вычислительной серверная часть использует очередь сообщений RabbitMQ. Это делает их слабо зависимыми друг от друга, а также решает задачу сохранения еще не выполненных задач.

Вычислительные модули и организация взаимодействия с ними

Алгоритмы численной инверсии, лежащие в основе одного из методов геонавигации, требуют значительных вычислительных мощностей, особенно для трехмерных моделей среды.
Для повышения быстродействия используются распределенные масштабируемые и высокопроизводительные параллельные вычисления. Численная инверсия данных ЭМК выполняется последовательно в заданных интервалах скважины (инверсионных окнах). Это делает возможным организацию параллельных вычислений на графических ускорителях и сопроцессорах.
Высокопроизводительные вычисления требуют распараллеливания кода на низкоуровневых ЯП (С++ / Fortran). Использование таких языков требует предварительной компиляции кода со всеми необходимыми зависимостями под каждый вычислительный ресурс. Для проверки корректности работы алгоритма его необходимо тестировать на каждой машине в отдельности. Альтернативным вариантом является запуск программы с помощью платформы Docker. Достаточно поместить вычислительную программу и все ее зависимости в Dockerконтейнер вместе со скриптом, передающим данные из очереди сообщений в программу и возвращающим результаты. Такой контейнер работает быстро и надежно вне зависимости от вычислительного окружения, как на Linux, так и на Windows.

Методы геонавигации

Разработанное ПО позволяет проводить оперативную интерпретацию данных каротажа в процессе бурения, полученных комплексом «ЛУЧ». За проведение геонавигации отвечают модули «Корреляция» и «Инверсия», использующие методы корреляции каротажных данных и численной инверсии соответственно.

Корреляция каротажных данных

Бол́ьшая часть существующих программных решений для геонавигации основана на идейно близких методах, имеющих в литературе различные названия: «модельно-стратиграфический», «сравнения каротажных данных», «матчинг», «model-compare-update» [7; 8]. Их суть состоит в сопоставлении данных, измеряемых приборами в процессе бурения, и синтетических данных, полученных в моделях среды, построенных по опорным скважинам. По этим априорным данным создается двумерная модель части разреза, в которой предполагается проводить горизонтальный участок скважины. Синтетические диаграммы каротажа вычисляются в такой модели на проекции запланированной траектории горизонтальной скважины.
Начальная модель корректируется так, чтобы добиться совпадения между синтетическими и практическими данными.
В разработанном ПО каротажные данные пилотной субвертикальной скважины, приведенные к истинной вертикальной глубине, распространяются по латерали, тем самым формируя стартовую двумерную модель геологической среды. Синтетические каротажные диаграммы в горизонтальной скважине, как правило, получают путем линейной интерполяции данных модели среды в точках с соответствующими вертикальными глубинами. Однако линейная интерполяция не учитывает влияния прилегающих пластов (вмещающей среды) на сигналы ЭМК, которое обусловлено большой глубинностью метода. В связи с этим синтетические сигналы ВИКПБ рассчитываются с помощью специально разработанных алгоритмов численного моделирования.
Геонавигатор работает с данными, привязанными к глубине по стволу скважины, а также с их проекциями на вертикальную и горизонтальную оси. Стартовая модель разбивается на блоки по горизонтали, при этом для каждого из блоков задается свой угол наклона (рис. 3). При наличии предпосылок в модель могут вводиться разломы, т. е. линии, на которых происходит скачкообразное изменение параметров модели. После каждого изменения параметров модели или траектории скважины синтетические каротажные диаграммы рассчитываются заново, и процесс подбора повторяется. Достоверность модели, полученной в результате таких операций, достигается за счет наилучшего совпадения синтетических и практических данных каротажа в процессе бурения. Совпадение признается достаточным, если различие между практическими и синтетическими данными в среднем не превышает погрешности измерений. Однако метод геонавигации на основе корреляции каротажных данных обладает существенным недостатком. Поскольку датчики каротажных приборов располагаются на некотором удалении от бурового долота, пересечение геологической границы определяется лишь постфактум. Траекторию скважины корректируют, чтобы вернуться в пласт, а не просто удержаться в нем. Такие способы геонавигации принято называть «реактивными». Незапланированные пересечения геологических границ зачастую приводят к нежелательным последствиям. В частности, пересечение водонефтяного контакта может привести к поступлению воды в скважину, а вскрытие газовой шапки – и вовсе к аварийной ситуации.

Численная инверсия данных ЭМК

В противоположность реактивным выделяют «проактивные» методы геонавигации, когда траекторию скважины корректируют до того, как произойдет нежелательное пересечение геологической границы буровым долотом. Радиальная глубинность исследования ВИКПБ может достигать 3 м. Это позволяет проводить проактивную геонавигацию и картировать геоэлектрические границы коллектора в процессе бурения, используя алгоритмы численной инверсии сигналов прибора. Численная инверсия данных ЭМК представляет собой целенаправленный подбор параметров геоэлектрической модели путем минимизации функционала невязки измеренных и синтетических данных. В разработанном ПО моделирование синтетических данных проводится путем численного решения прямой задачи ЭМК в классе слоисто-однородных моделей методом разделения переменных. Минимизация функционала невязки выполняется с использованием алгоритма на основе метода деформируемых многогранников.
Разработанное ПО предоставляет пользователю гибкий интерфейс для выполнения пооконной инверсии сигналов ВИКПБ в автоматическом и ручном режимах (рис. 4). Геонавигатор загружает входные данные, выбирает интервал для инверсии, устанавливает ширину и перекрытие окон. Стартовая модель для инверсии подбирается, исходя из априорных данных, либо импортируется из модуля геонавигации методом корреляции каротажных данных.
Алгоритм численной инверсии позволяет использовать произвольные комбинации сигналов из полного набора измерений ВИКПБ. Благодаря этому при ограниченной скорости передачи данных в реальном времени для инверсии можно задействовать только часть измеряемых сигналов. Уточнить параметры модели можно, получив всю информацию из памяти прибора, после его подъема из скважины на поверхность. Применение метода геонавигации с использованием численной инверсии данных ВИКПБ позволяет картировать границы пласта-коллектора и заблаговременно корректировать траекторию скважины в процессе бурения, не пересекая сами границы. Такой подход значительно повышает эффективную длину ствола скважины, т. е. расстояние, пройденное скважиной внутри продуктивного пласта. Помимо этого, инверсия данных ЭМК позволяет изучать электрофизические характеристики отложений, не вскрытых скважиной и располагающихся ниже по разрезу. Методы геонавигации скважин развиваются в связи с возникновением практической потребности нефтегазовой отрасли в высокоточной проводке скважин с горизонтальным завершением во все более сложных геологических условиях. При этом ключевую роль играет развитие аппаратурной базы наклонно направленного бурения и каротажа в процессе бурения. Дальнейшее развитие методического аспекта ПО связано с внедрением модуля интерпретации скважинных имиджей УЭС, предоставляемых азимутальным прибором БКС.

Заключение

Разработано ПО для геологического сопровождения бурения с использованием данных аппаратурного комплекса для каротажа в процессе бурения «ЛУЧ». Алгоритмическая составляющая ПО реализует два метода геонавигации. Первый использует традиционный подход корреляции каротажных данных, второй – численную инверсию данных ЭМК. Использование этих методов в комплексе позволяет повысить достоверность результатов интерпретации данных каротажа в процессе бурения, что приводит к более эффективной проводке скважины. Предложен облачный сервис для обработки и интерпретации геофизических данных с использованием кроссплатформенных распределенных масштабируемых вычислений. Использование современных вычислительных технологий позволяет значительно ускорить решение задачи численной инверсии, что необходимо для оперативной геонавигации.