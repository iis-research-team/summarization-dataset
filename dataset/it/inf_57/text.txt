В начале второго десятилетия XXI в. нейрофизиология уверенно перешла с уровня изучения анатомии мозга на уровень изучения мыслительных процессов, что обусловлено развитием как методов измерения, так и методов обработки данных. Наиболее популярные методы
получения исходных данных – магнитно-резонансная томография (МРТ) и электроэнцефалография (ЭЭГ). МРТ обеспечивает выделение активных зон в мозгу по признаку повышения
в них уровня кислорода с высоким пространственным разрешением (порядка 1 мм) [1]. Методы ЭЭГ привлекательны тем, что нейронная активность регистрируется непосредственно [2] – в ЭЭГ измеряются колебания напряжения на поверхности головы, возникающие
в результате ионного тока в нейронах мозга. При этом существуют хорошо зарекомендовавшие себя методы, реализованные, например, в пакете программ sLORETA [3], которые
по снятым с поверхности головы ЭЭГ-сигналам определяют источники этих сигналов внутри
мозга. Таким образом, методами ЭЭГ можно исследовать быстротекущие мозговые процессы [4].
В Лаборатории дифференциальной психофизиологии Института физиологии и фундаментальной медицины в течение последнего десятилетия активно проводятся исследования,
включающие сбор ЭЭГ-данных. Накопленные значительные объемы экспериментальных
данных позволяют повторно использовать эти данные для проверки новых гипотез. Однако,
поскольку экспериментальная база – как приборная, так и программная – в течение этого
времени несколько раз обновлялась, накопленные данные разнородны, и их обработка сопряжена с большим объемом рутинных ручных операций. Создание «с нуля» проприетарного программного обеспечения, автоматизирующего этот процесс, чрезвычайно трудоемко [5],
поэтому остро стоит проблема поиска варианта переиспользования уже существующих открытых программных компонентов для обработки разнородных ЭЭГ-данных.
В статье описан автоматизированный подход к проверке гипотез с использованием разнородных ЭЭГ-данных: описываются программно-инструментальные средства получения экспериментальных данных, разработанные алгоритмы их предварительной обработки и унификации, способы восстановления, в том числе 3D реконструкции, и общая схема проверки
гипотез методом медиационного анализа.
Программно-инструментальные средства получения ЭЭГ-данных
Проверка гипотез проводится статистическими методами на основании данных, получаемых через обследование испытуемых. Данные включают результаты анкетирования испытуемого (пол, возраст, социальное положение, национальность и т. д.) и компьютерные записи, сделанные во время эксперимента.
Для проведения эксперимента на голову пациента надевается специальный ЭЭГ-шлем,
на котором расположены электроды, соединенные с электроэнцефалографом. На каждом
электроде измеряется электрический потенциал, который записывается с частотой 1 кГц.
За нулевой потенциал принимается потенциал электрода в районе темени.
Эксперимент (рис. 1) состоит в выполнении испытуемым элементарных тестовых заданий, называемых эпохами: сначала на монитор, расположенный перед испытуемым, выводится картинка – стимулирующее воздействие (фотография человеческого лица, выражающего некоторое эмоциональное состояние), и текст с вариантами реакции (список возможных действий); с помощью клавиатуры испытуемый выбирает один из вариантов, после чего
запускается следующая эпоха. 
Эксперимент проводится в автоматическом режиме. Выдачу стимулов и регистрацию реакции осуществляет программа управления экспериментом INQUISIT. Запись данных производится при помощи электроэнцефалографов компаний Neuroscan (ЭЭГ-шлем имеет 118
электродов) или Brain Products (ЭЭГ-шлем имеет 128 электродов) и соответствующего фирменного ПО.
После проведения эксперимента с помощью прибора FASTRAK digitizer (Polhemus) измеряются координаты электродов ЭЭГ-шлема и так называемых референтных точек, которые характеризуют форму головы испытуемого. Местоположение референтных точек определяется по стандартизированной процедуре относительно ушей, носа и затылка [6].
Таким образом, во время эксперимента создаются четыре файла: файл с записью ЭЭГсигналов (cnt-файл), содержащий метки начала эпох, файл протокола эксперимента (с данными о стимуле, времени и типе реакции), файл координат электродов и файл координат референтных точек. Совместно с результатами анкетирования испытуемого эти четыре файла
образуют исходный набор данных отдельного эксперимента, из которых собирается база
данных.
Из-за различий в оборудовании (разное количество электродов) собранная база данных
существенно разнородна: при использовании оборудования компании Neuroscan записывается 118 каналов, а при использовании оборудования компании BrainProducts – 128. Совпадающих каналов только 98. Также различается и порядок записи каналов. Кроме того, из-за изменений во внутрилабораторных стандартах часть протоколов экспериментов записана
в простом текстовом виде, а часть – в html-формате. Файлы протоколов отличаются и по информационной структуре.
Дополнительная сложность использования снятых данных обусловлена низким уровнем
полезного сигнала: мышечные напряжения в области головы (скулы, глаза, язык и т. д.) приводят к появлению так называемых «артефактов» – паразитных импульсов, которые заглушают сигналы нейронной активности. Также недопустимое искажение сигнала может возникнуть и при плохом контакте датчика с поверхностью головы. Нарушение контакта может
возникнуть как из-за некачественного крепления электрода лаборантом, так и из-за резких
движений головой испытуемого.
Методы обработки и унификации ЭЭГ-данных
Подготовку ЭЭГ-данных к последующей обработке начинают с исключения «артефактов». Несмотря на наличие автоматических средств удаления «артефактов» [7], исследователи предпочитают производить первичное удаление явно зашумленных участков и каналов
вручную, поскольку на настоящий момент результаты ручной обработки оказываются точнее. Дальнейшая коррекция полученных ЭЭГ-данных проводится методом анализа независимых компонентов [8] в программном пакете EEGLAB toolbox, статистическая суть обработки приведена в [9]. Обработанные с помощью EEGLAB данные сохраняются в бинарном
set-файле. Формат set-файла ориентирован на пакет MATLAB, широко используемый научным сообществом для обработки цифровых сигналов [10].
Во время обработки могут быть удалены существенные объемы данных: после устранения
артефактов может выясниться, что отсутствуют данные как о целых эпохах, так и об отдельных каналах.
Потеря канала приводит к дополнительным нарушениям в однородности данных, что радикально усложняет последующую групповую обработку set-файлов. С другой стороны, исключение утраченного канала из остальных set-файлов с целью унификации влечет недопустимую потерю информативности всей выборки.
Исходя из этих соображений, утраченные каналы восстанавливаются встроенной процедурой межканальной интерполяции EGGLAB. Предполагается, что восстановление делается
во время устранения артефактов, в ручном режиме. Однако это чревато ошибками из-за человеческого фактора.
Для автоматизации процедуры восстановления утраченных каналов был разработан алгоритм пакетного восстановления каналов по заданному образцу, который реализован в виде
скрипта в пакете MATLAB. Для восстановления каналов также используется метод сферической сплайн-интерполяции, предоставляемый библиотекой eeglab. И хотя сам метод восстановления считается в целом приемлемым [11] при его использовании возникает ограничение
на качество исходных данных (количество утраченных каналов), поскольку в случае, если
значительная часть каналов будет восстановлена интерполяцией, использование метода приведет к снижению значимости результатов корреляционного анализа. Для унификации форматов set-файлов, полученных на различном оборудовании (Neuroscan и Brain Products), несовпадающие каналы исключаются из обработки [12], что обусловлено значительными
искажениями, возникающими при интерполировании большого количества несовпадающих
каналов (около 20 % от общего числа).
Для автоматизации процесса унификации был предложен алгоритм (рис. 2) пакетной обработки set-файлов в выбираемых пользователем двух корневых директориях с данными,
полученными на оборудовании Neuroscan и Brain Products соответственно. Алгоритм формирует результаты во вновь создаваемых директориях. Порядок следования каналов определяется в соответствии с set-файлами из первой директории. Таким образом, сначала алгоритм фиксирует порядок следования каналов и определяет
пересечение множеств каналов Neuroscan и Brain Products, а потом последовательно считываются set-файлы. Из очередного set-файла исключаются отсутствующие в пересечении каналы, и при необходимости изменяется порядок их следования. Алгоритм по унификации
set-файлов реализован в виде MATLAB-скрипта и библиотеки EEGLAB.
3D-реконструкция источников электрической активности мозга
ЭЭГ оборудование регистрирует потенциалы на поверхности головы, в то время как исследовательский интерес представляют источники электрических сигналов, расположенные
в головном мозге, локализация этих источников в функциональных областях коры головного
мозга. Пространство, в котором производится поиск источников, задается трехмерной моделью мозга, основанной на так называемом атласе Талайрака [13]. Определение координат
и параметров источников электрической активности в головном мозге по ЭЭГ-данным (или
3D-реконструкция) производится на основе решения обратной задачи [14].
Имеется множество методов 3D-реконструкции по записям электрической активности
с поверхности головы, таких как MN (минимальная норма), WMN (взвешенная минимальная
норма), Backus and Gilbert, and WROP (weighted resolution optimization) [15], 3D-моделирование на основе глубинных нейронных сетей [16] и др. В работе 3D-реконструкция проводилась программой sLORETA [3], использующей MN-метод. Выбор способа был обусловлен
простотой использования пакета sLORETA при удовлетворительном качестве 3D-реконструкции.
Перед 3D-реконструкцией set-файлы преобразуются к входному формату sLORETA. Подготавливаются файлы с координатами электродов и реперных точек, а также данные о спектральной мощности сигналов, разбитые на эпохи и частотные диапазоны. Подготовка входных файлов в формате ASCII (asc-файлов) производится автоматически из set-файлов
в соответствии с границами частотных диапазонов, задаваемыми пользователем. Обычно
разбивка производится по пяти стандартным частотным диапазонам: δ-ритм (1–4 Гц), θ-ритм
(4–8 Гц), α-ритм (8–12 Гц), β-ритм (12–35 Гц), γ-ритм (35–45 Гц). Алгоритм подготовки
входных данных для sLORETA реализован в виде MATLAB-скрипта на основе библиотеки
EEGLAB.
В результате работы пакет sLORETA формирует набор slor-файлов. Каждый slor-файл характеризует мозговую активность во время отдельного теста (эпохи) в выделенном частотном диапазоне. Slor-файл содержит воксельную модель мозга и амплитуды сигналов в каждом отдельном вокселе. Стандартный размер вокселя – 5 × 5 × 5 мм. При этом мозг
представлен трехмерным массивом 29 × 34 × 24 (всего 23 664 вокселя).
Для последующей обработки полученные файлы преобразуются в de facto стандартный
расширяемый NIFTI-формат, ориентированный на воксельное представление нейроизображений мозга [17]. Преобразование ведется в пакетном режиме созданном MATLABскриптом с использованием библиотеки spm8.
Проверка гипотез
методом многоуровневого медиационного анализа
Многоуровневый медиационный анализ (рис. 3) [18] основан на классической трехкомпонентной медиационной модели, в которой сначала средствами линейного регрессионного
анализа определяется связь между независимой переменной X и медиатором M (путь a)
и связь между медиатором M и зависимой переменной Y (путь b), а затем определяется медиационный эффект (путь ab, т. е. влияние X на Y, опосредованное M) как произведение регрессионных коэффициентов, полученных методом так называемого бутсрэппинга [19]. Медиационный анализ проводится повоксельно, т. е. медиационный эффект вычисляется для
каждого отдельного элемента воксельного представления мозга.
Медиационный эффект может быть как положительным (наблюдается одинаковый знак
регрессионного коэффициента пути a и пути b), так и отрицательным (путь a и b имеют
противоположные знаки регрессионных коэффициентов).
Перед проведением медиационного анализа было предложено унифицировать представление эксперимента. Для этого был разработан формат компактного представления протокола единичного эксперимента – модельная матрица. Она задается двумерной матрицей, состоящей из пяти столбцов (номер эпохи, два признака стимула, тип реакции, время реакции).
Число строк модельной матрицы равно числу эпох в эксперименте.
Алгоритм создания модельных матриц реализован расширяемым набором MATLABскриптов, обеспечивающих пакетную обработку протоколов в текстовом и html-форматах.
Полученные в результате обработки протоколов модельные матрицы записываются на диск
в виде mat-файлов пакета MATLAB, ориентированных на хранение данных. Повоксельное проведение медиационного анализа приводит к появлению ложно детектируемых вокселей. Фильтрация ложно детектируемых вокселей производится на основании
того, что при реакции у испытуемого активируются области мозга, по размеру превышающие размер единичного вокселя. Таким образом, после медиационного анализа отбрасываются единичные воксели и группы связанных вокселей (так называемые кластеры) небольшого размера. Граничный размер кластера определяется функцией alphasim [20]
из библиотеки Neuroelf на основании размера матрицы, содержащей воксельное представление мозга, и порога достоверности через симуляцию шума.
Таким образом, реализованный пакет MATLAB скриптов производит унификацию протоколов, создает модельные матрицы, затем на основании данных о стимулах / реакциях
и воксельного представления мозга выявляет воксели-медиаторы, вычисляет граничный размер кластеров и в заключение исключает из рассмотрения единичные воксели и кластеры
с размером меньше граничного. В результате получается набор воксельных моделей с областями, участвующими в выработке реакции, для каждого из исследуемых частотных диапазонов.
Координаты обнаруженных кластеров сопоставляются с картой функциональных зон
мозга и служат объективной основой для интерпретации когнитивных процессов специалистами-нейрофизиологами, подтверждают или опровергают существующие гипотезы о характере нервной деятельности при социальном взаимодействии.
Таким образом, разработаный комплекс программ (рис. 4) включает компонент автоматического восстановления утраченных каналов, гомогенизацию ЭЭГ-файлов по составу и порядку следования каналов, 3D-реконструкцию источников мозговой активности и медиационный анализ с выявлением воксельных кластеров, задействованных в выработке реакции
на стимул.
Практическая апробация разработанного пакета программ
Разработанный пакет программ использовался при обработке экспериментов по социальному взаимодействию. Методика эмпирической проверки гипотезы приведена в [21; 22]. Единичный эксперимент включал 60 эпох. В качестве стимулов
использовались фотографии мужских и женских лиц с тремя
эмоциональными выражениями («счастливое» / «нейтральное» /
«агрессивное»). В качестве реакции испытуемым предлагалось
три варианта: «подружиться», «уклониться от контакта», «атаковать».
Всего было обработано 43 эксперимента, из них 32 эксперимента проведены на оборудовании компании Neuroscan (datформат протоколов) и 11 – на оборудовании Brain Products
(HTML-формат протоколов). При обработке отбраковано 20 каналов по причине низкого качества, которые затем были восстановлены автоматически. В процентном отношении это составило менее 0,5 % от общего числа обрабатываемых каналов
(пиковое значение – 2 % восстановленных каналов у одного испытуемого). И если дополнительно учесть, что утраченные каналы восстанавливались интерполяционным методом, можно
утверждать, что проведенная коррекция исходных данных незначительно повлияла на результаты последующей обработки.
3D-реконструкция проводилась по стандартным частотным
диапазонам (альфа / бета / гамма / тета / дельта). При этом в качестве временных интервалов, по которым определялась мозговая активность, использовался промежуток от предъявления
стимула до фиксации реакции. Воксельное представление мозга
задавалось матрицей размером 29 × 34 × 24 (размер вокселя
5 × 5 × 5 мм). Использовался порог достоверности, равный
0,001. Граничный размер кластера составил 13 вокселей.
Значение независимой переменной (соответствующей стимулу) для агрессивного выражения лица устанавливалось равным
1, для нейтрального – 0, для счастливого – минус 1. Значения
зависимой переменной (соответствующей реакции) для случая
«атаковать» устанавливалось равным 1, для «уклониться от контакта» – 0, для «подружиться» – минус 1.
Результаты, полученные при практической апробации и представляющие нейрофизиологический интерес, изложены в статье
[23]. Разработанные скрипты были частично использованы при
исследовании нейрофизиологических различий у людей с коллективистской и индивидуалистской ориентацией.
Заключение
Предложен подход для автоматизации проверки гипотез на основе обработки разнородных ЭЭГ-данных. Подход включает унификацию ЭЭГ-записей, сделанных на различном
оборудовании, восстановление утраченных данных, 3D-реконструкцию источников мозговой
активности по исходным ЭЭГ-данным и проведение медиационного анализа. Реализация
подхода базируется на наборе MATLAB-скриптов, использующих библиотеки EEGLAB,
NeuroElf, Alphasim, spm8, Mediation toolbox, и программном пакете sLORETA. Созданный
инструментарий апробирован при обработке данных нейрофизиологических экспериментов
по социальному взаимодействию. В силу своей универсальности представленные скрипты,
автоматизирующие статистическую обработку разнородных ЭЭГ-данных, могут использоваться для проверки широкого класса нейрофизиологических гипотез. 