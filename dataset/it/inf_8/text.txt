Введение

На текущий период времени остро стоит вопрос энергетической безопасности как стран в целом, так и отдельных регионов. Одним из эффективных средств решения данной проблемы является использование природного газа. Сегодня основным безопасным, независящим от погодных условий и ритмичным средством доставки является трубопроводный транспорт. Кроме того, магистральные газопроводы транспортируют газ на большие расстояния. Для обеспечения передачи заданных объемов газа используется рабочее давление, превышающее 100 атмосфер. Соответственно, предъявляются высокие требования к механической прочности трубопроводов, и это обеспечивается за счет использования стальных труб. Известно, что транспортируемый природный газ состоит в основном из метана, до 98%. Помимо этого, он также может содержать всевозможные примеси как в твердом состоянии, механические примеси в виде песка и возможной окалины, так и в жидком состоянии, в виде водяных паров и конденсатов тяжелых фракций углеводородов. Жидкие примеси, присутствующие в природном газе, оказывают корродирующее действие на внутреннюю поверхность газопровода, что приводит к утончению его несущей стенки и, соответственно, ее механической прочности. Данная проблема является чрезвычайно актуальной, и ей посвящен ряд современных публикаций по выявлению причин данного явления и борьбы с ним. Критические значения утончения стенки в конечном результате приведут к невозможности эксплуатации трубопровода и, соответственно, уменьшению времени его эксплуатации.
В связи с этим актуальной задачей становится определение текущего состояния стенок газопровода. Наиболее актуальными являются методики неразрушающего контроля, одна из которых – ультразвуковая дефектоскопия. При таких исследованиях определяют в обобщенном виде времена прихода отраженных сигналов от внутренней и внешней стенок газопровода. Методы и техническая реализация на сегодняшний день чрезвычайно развиты, но применение на объектах гигантской протяженности чрезвычайно затруднительно. Решением данной проблемы является создание автоматизированных внутритрубных инспекционных приборов (ВИП). Одним из вариантов реализации таких приборов является дефектоскоп внутритрубный ультразвуковой (ДВУ), примерами реализации могут быть внутритрубные дефектоскопы 10-УСК.04-00.000 [6] и 40-ДФР.00-00.000.
Цель настоящей работы – проведение нейросетевого анализа данных, направленного на автоматизацию обнаружения дефектов стенок газопроводов по результатам их ультразвукового исследования, при том что обрабатываемые данные представлены показаниями нескольких десятков тысяч точек измерений. Исходя из этого, к задачам исследования можно отнести выбор нейросетевой модели, подготовку исходных данных для выбранной нейронной сети (НС), обучение НС и проведение вычислительных экспериментов для достоверного определения зон дефектов.

1. Программно-аппаратная система ДВУ

Программно-аппаратная система ДВУ позволяет генерировать ультразвуковые сигналы и регистрировать данные их прохождения с 400 датчиков, расположенных по окружности трубы, при этом устройство с датчиками перемещается вдоль оси трубы с заданной скоростью. Соответственно, генерируется гигантский объем данных, который необходимо проанализировать. Совместно с зарегистрированными данными для исследования были получены данные о дефектах, их расположение в координатах «датчики–продольная ось трубы». Следует заметить, что доля данных, отвечающих «дефектам», в общей выборке очень мала и, как правило, не превышает единиц процентов.
В программно-аппаратной системе ДВУ для каждого датчика должно быть зарегистрировано по 31 значению времени и амплитуды отраженного сигнала. Для анализа исходных данных и выявления признаков на данных, соответствующих дефектам, проведена визуализация измерений в виде распределения амплитуд возвращенных волн во времени. Как правило, получается следующая картина (рис. 1). Можно видеть, что на графике присутствуют характерные группировки амплитуд, соответствующие интенсивностям возвращенного сигнала, и некоторые данные, которые явно можно отнести к шумам, вызванным различными физическими процессами, связанными как с волновыми процессами, так и процессами в системе измерения. Амплитуда отраженного сигнала при многократных отражениях уменьшается. На графике точками помечены центры отраженных ультразвуковых сигналов, которые могут быть теоретически использованы для пересчета толщины стенки, например за счет статистической обработки данных измерений. Если рассматривать зарегистрированные данные для нескольких датчиков сразу, то получим следующую картину распределения данных о прохождении волн (рис. 2). Выделенный жирной линией замер с номером 87 отвечает сигналам из зоны с дефектом. На рисунке видны для номеров замеров положений до 88 и после 93 характерные области с данными, отвечающие отраженным сигналам, расположенным согласно правилам распространения волн. На этом же рисунке присутствуют зарегистрированные данные со смещением центров наборов данных по оси времени для областей с одной из сторон дефекта.
Однако в некоторых случаях картина регистрации данных будет совсем удручающей для методов математической статистики (рис. 3). На рисунках представлены данные для одного сечения трубы: на рис. 3, а – данные для начальных детекторов в сечении, а на рис. 3, b – конечные детекторы.
Соответственно, точки замера находятся рядом. Зоне дефекта соответствует рис. 3, а, жирные линии, а зоне без дефектов – рис. 3, b. Анализ визуализированных данных позволяет сделать вывод о том, что картина не отвечает «общепринятой» картине регистрируемых данных, что может быть обусловлено различными причинами – как физического характера, так и проблемами с регистрацией данных электронными приборами. Большое количество данных, неоднородность их получения и стремление к автоматизации прогнозного определения зон дефектов приводят к идее воспользоваться методами обработки данных, основанными на машинном обучении. Условно «классические» методы решения такого класса задач авторам неизвестны.
Популярной практикой при ультразвуковой дефектоскопии больших поверхностей является визуализация, т.е. создание проекций отраженных сигналов. Формируется двумерная картина, где цветом отражаются особенности прохождения сигнала, схема которого представлена на рис. 4. Если весь набор данных рассматривать как итог формирования некоторой картины, то для задачи определения мест дефекта можно воспользоваться сверточными нейросетями, хорошо себя зарекомендовавшими при работе с изображениями.

2. Сверточные нейронные сети

Сверточные нейронные сети, как и большинство нейронных сетей, состоят из нескольких слоев: сверточные слои (convolutional layer), которые могут чередоваться со слоями подвыборки, или избирательными слоями, или слоями пулинга (pooling layers), а также завершающие полносвязные слои. Чем больше слоев, тем мощнее архитектура и лучше обучение нейронной сети. Количество слоев может достигать нескольких десятков. На этапе свертки нейронная сеть агрегирует данные, что в дальнейшем поможет анализу изображения. В общем случае свертку можно создавать для каждого признака. Нейронная сеть будет подбирать их во время распознавания и классификации на каждом сверточном слое. Операция пулинга (pooling) представляет собой алгоритм уменьшения входного тензора по пространственным осям и выделения наиболее важных признаков. Существует множество видов пулинга, среди них можно выделить: max pooling – операция выбирает наибольший элемент из части изображения, покрытой ядром пулинга; mean pooling – операция выбирает средний элемент; min pooling – соответственно, минимальный. Алгоритм предполагает выбор размера фильтра пулинга, шага его движения и типа пулинга, после чего ядро пулинга последовательно накладывается на части входного изображения с выбранным шагом, а к части выходного изображения, покрытой ядром пуллинга, применяется его операция. Завершением НС служат один или несколько полносвязных слоев, предназначенных, как правило, для классификации.
При работе с зарегистрированными ДВУ данными предполагается подавать на вход некоторой НС тензор с размерностью, определяемой как произведение количества строк на количество столбцов и количество каналов, а на выходе ожидать информацию о наличии или отсутствии дефектов. В качестве значений для каналов предполагается использовать значения времен и амплитуд для каждого измерения, представленных одномерным массивом. Таким образом, сформированный тензор можно считать изображением с большим количеством каналов.

3. Результаты тестирования

Для визуализации принципа работы сверточной НС удобнее всего использовать развернутую карту дефектов, поскольку ее значительно проще визуализировать, чем данные, считанные ДВУ в полном объеме, так как последние представляют собой трехмерный тензор. В рамках данного подхода оба набора измерений воспринимаются как изображения, содержащие разное количество каналов. В качестве входных данных НС предполагается использовать изображение, меньшее по высоте и ширине, чем исходное. А так как размер изображения задается по осям высоты и ширины, а данные, считанные ДВУ, и развернутой карты дефектов равны, то изображение, представляющее собой обрезанную зону развернутой карты дефектов, будет соответствовать такой же зоне в данных ДВУ с той лишь разницей, что они будут иметь разное количество каналов.
Тогда, имея карту признаков, можно обрезать ее часть некоторого размера и использовать ее как выходные данные НС, а как входные данные использовать соответствующий тензор. Количество датчиков и измерений представляется как ширина и высота изображения, а числа в каждой ячейке – как каналы с той разницей, что в RGB-изображениях 3 канала, а для анализируемых данных – вплоть до 64. Развернув данные в двумерную картину, получим следующее изображение (рис. 5), где по горизонтальной оси – номера датчиков, а по вертикальной – номера измерений вдоль оси трубы. На рисунке фиолетовый пиксель соответствует состоянию «отсутствие дефекта», желтый – «дефект».
При подготовке данных получено одно «изображение» размера не менее ста строк, 400 столбцов и 64 канала (время и амплитуда отраженного сигнала). К этим данным формируется маска с ранее заданным количеством строк и столбцов и одним каналом, определяющим наличие и отсутствие дефекта. Для обучения сети такой вид данных не подойдет по причине малого количества наблюдений и большого размера самого наблюдения. Вывод о том, что наблюдение слишком большое, сделан на основе реализации решения задачи при работе с изображениями на нейронной сети VGG16. При обработке в нейронной сети VGG16 на вход подается, как правило, порядка сотен тысяч значений и сеть имеет глубину более 15 слоев, по этой причине использование данной сети не подходит для нашего обрабатываемого набора значений, поскольку потребует обработки более двух миллионов значений.
В качестве решения данной проблемы предлагается разбить имеющееся изображение на кропы.
Кроп – часть изображения меньшего размера, но с таким же количеством каналов. Первой задачей для последующего обучения явилась задача выбора размеров кропа. В исследованиях использовались следующие значения стороны квадратного кропа: 8, 16, 24, 48. Ни одно из значений явных преимуществ перед другими не дало.
Поскольку в выборке мало дефектов, то для обучения предлагается провести аугментацию данных, т.е. искусственное увеличение выборки. Аугментация проводилась только для кропов с дефектами. Кроме того, стоит отметить, что проводилась только геометрическая аугментация со следующими операциями: поворот изображения кропа на 90° (три варианта), отражение изображения по горизонтали, отражение по вертикали. Для увеличения количества кропов с дефектами предложена аугментация со сдвигом изображения как по горизонтали, так и по вертикали на половину величины кропа с последующей склейкой недостающей части.
Итоговая нейросетевая модель состояла из двух блоков выделения признаков для значений времен и амплитуд, имеющих одинаковую архитектуру, но разные функции активации с учетом того, в каких пределах располагаются значения каждой выборки. Общая схема такого блока представлена на рис. 6. На вход подается исходный кроп как часть из общего набора данных, размером 64 × 64 «пикселя». Используя слои расширенной свертки с билинейной повышающей дискретизацией и слои пуллинга с использованием операции max pooling получаем 512 «рисунков» 1 × 1. Данная процедура проделывается как для блока значений амплитуд интенсивностей отраженных волн, так и времен.
Далее выходы двух таких блоков объединялись. Общая схема архитектуры нейронной сети представлена на рис. 7. За счет операции конкатенации и использования набора полносвязанных слоев НС на выходе получим бинарный ответ: содержит ли данный кроп в своем составе точки дефектов.
Исходные данные вручную разбиты на три выборки: обучающую, валидационную и тестовую.
Это позволяет говорить о том, что вероятность переобучения нейронной сети и проблемы с внешним ковариационным сдвигом предусмотрены и данные подготовлены правильно. Также данные внутри всех трех выборок были перемешаны, что позволило процесс обучения сделать более стабильным и качественным.
Стоит заметить, что выходными данными для такой НС является одномерный массив логических значений. Для обучения нейронной сети такой массив создан на основании уже имеющихся выходных данных. Исходные данные имели точки дефектов, приближенные к краям исследуемой области (см. рис. 5). Для исключения краевых эффектов при обучении и последующего тестирования массив был преобразован сдвигом на заданную величину, что позволило получить область дефектов во внутренних областях данных (рис. 8). Операция, на взгляд авторов, допустима, поскольку данные снимаются с поверхности трубы и определение начала и конца окружности чрезвычайно условно. На подготовленных данных производилось обучение построенной нейронной сети с использованием функции потерь в виде среднего квадрата ошибки (mean squared error). График функции ошибки в процессе обучения на тренировочной и валидационной выборках представлен на рис. 9.
Из анализа данных можно сделать вывод об отсутствии переобучения ввиду отсутствия расхождения графиков ошибки на валидационной и тренировочной выборках. Наименьшее значение функции ошибки на тренировочной выборке составило 0,0024, на валидационной – 0,0032. НС протестирована, в результате значение функции ошибки составило 0,0408 На тестовом наборе данных проведено исследование расположения области дефектов. Результаты работы модели нейронной сети представлены на рис. 10. Наиболее светлые точки рисунка отвечают зонам с наибольшей вероятностью дефектов. В целом предсказанная область накрывает область дефектов тестовой выборки (рис. 8).

Заключение

В работе представлен нейросетевой анализ данных с использованием сверточных нейронных сетей. Имеющиеся входные данные были разбиты на обучающую, валидационную и тестовую выборки.
Кроме того, данные внутри выборок были перемешаны, что позволило процесс обучения сделать более качественным.
Для обучения модели была использована нейросеть, построенная с использованием сверточных слоев. Функция потерь в виде среднего квадрата ошибки была применена для оценки точности модели. Из проведенного анализа данных можно сделать вывод, что у модели отсутствует переобучение, так как графики ошибки на валидационной и тренировочной выборках не расходятся. После обучения НС была протестирована на тестовом наборе данных, и значение функции ошибки составило 0,0408. Это позволяет оценить точность модели и ее способность предсказывать зоны дефектов.
В целом нейросетевая модель показала свою практическую применимость для предсказания зон дефектов магистральных газопроводов.